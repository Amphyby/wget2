#!/bin/bash

shopt -s extglob # enable pattern matching for 'case'

err=0

# won't process these options
excludes="+(--no-quiet|--html-extension)"

for opt in `src/wget2 --help|egrep -o -- '--[a-zA-Z0-9-]+'|sort -u`; do
  # skip if in $excludes
  case $opt in $excludes) continue;; esac

  if ! egrep -q -- " \`$opt(=|\`|\[)" docs/wget2.md; then
    # search for the --no- variant
    noopt="--no-`echo $opt|cut -c3-`"
    if ! egrep -q -- " \`$noopt\`" docs/wget2.md; then
      echo "Failed to find \`$opt in docs/wget2.md"
      err=1
    fi
  fi
done

exit $err
